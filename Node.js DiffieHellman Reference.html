<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node.js DiffieHellman Reference - Jassif Team Institution</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .content-section p, 
        .content-section li,
        .content-section h3,
        .content-section h4,
        .comparison-card p {
            color: #333 !important;
        }
        
        .tip-box p,
        .tip-box li,
        .tip-box h4 {
            color: white !important;
        }
        
        .warning-box p,
        .warning-box li,
        .warning-box h4 {
            color: white !important;
        }
        
        .exercise-box p,
        .exercise-box h4 {
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1>Jassif Team <span>Institution</span></h1>
            </div>
        </div>
    </header>

    <!-- Top Navigation Tabs -->
    <div class="nav-tabs">
        <a href="Node.js Decipher Reference.html" class="nav-tab prev">
            <i class="fas fa-arrow-left"></i>
            <span>роорпБроирпНродрпИроп</span>
        </a>
        <a href="Node.js ECDH Reference.html" class="nav-tab next">
            <span>роЕроЯрпБродрпНродродрпБ</span>
            <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h2>Node.js DiffieHellman Reference</h2>
            <p>Node.js роЗро▓рпН рокро╛родрпБроХро╛рокрпНрокро╛рой ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒ роирпЖро▒ро┐роорпБро▒рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро▒рпНроХро╛рой роорпБро┤рпБроорпИропро╛рой ро╡ро┤ро┐роХро╛роЯрпНроЯро┐</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- DiffieHellman Object -->
        <section class="content-section" id="diffiehellman-object">
            <h2>DiffieHellman Object</h2>
            
            <p>DiffieHellman ро╡роХрпБрокрпНрокрпБ Node.js роЗройрпН crypto родрпКроХрпБродро┐ропро┐ройрпН роТро░рпБ рокроХрпБродро┐ропро╛роХрпБроорпН. роЗродрпБ Diffie-Hellman ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒ роирпЖро▒ро┐роорпБро▒рпИропрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ, роЗродрпБ роЗро░рогрпНроЯрпБ родро░рокрпНрокро┐ройро░рпБроорпН рокро╛родрпБроХро╛рокрпНрокро▒рпНро▒ роЪрпЗройро▓ро┐ро▓рпН рокроХро┐ро░рокрпНрокроЯрпНроЯ ро░роХроЪро┐ропродрпНродрпИрокрпН рокро╛родрпБроХро╛рокрпНрокро╛роХ роиро┐ро▒рпБро╡ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.</p>
        </section>

        <!-- Import Crypto Module -->
        <section class="content-section" id="import-crypto">
            <h2>Import Crypto Module</h2>
            
            <div class="code-example">
                <pre><code>// Import the crypto module
const crypto = require('crypto');

// Create a DiffieHellman instance
const dh = crypto.createDiffieHellman(2048); // 2048-bit prime length</code></pre>
            </div>
        </section>

        <!-- DiffieHellman Methods -->
        <section class="content-section" id="diffiehellman-methods">
            <h2>DiffieHellman Methods</h2>
            
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>роорпБро▒рпИ</th>
                            <th>ро╡ро┐ро│роХрпНроХроорпН</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>dh.generateKeys([encoding])</strong></td>
                            <td>родройро┐рокрпНрокроЯрпНроЯ рооро▒рпНро▒рпБроорпН рокрпКродрпБ Diffie-Hellman ро╡ро┐роЪрпИ роородро┐рокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</strong></td>
                            <td>рооро▒рпНро▒ родро░рокрпНрокро┐ройрпН рокрпКродрпБ ро╡ро┐роЪрпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ рокроХро┐ро░рокрпНрокроЯрпНроЯ ро░роХроЪро┐ропродрпНродрпИроХрпН роХрогроХрпНроХро┐роЯрпБроХро┐ро▒родрпБ. inputEncoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, otherPublicKey роТро░рпБ роЪро░рооро╛роХ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer, TypedArray, роЕро▓рпНро▓родрпБ DataView. outputEncoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.getPrime([encoding])</strong></td>
                            <td>Diffie-Hellman роорпБродройрпНроорпИропрпИродрпН родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.getGenerator([encoding])</strong></td>
                            <td>Diffie-Hellman роЬрпЖройро░рпЗроЯрпНроЯро░рпИродрпН родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.getPublicKey([encoding])</strong></td>
                            <td>Diffie-Hellman рокрпКродрпБ ро╡ро┐роЪрпИропрпИродрпН родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.getPrivateKey([encoding])</strong></td>
                            <td>Diffie-Hellman родройро┐рокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИропрпИродрпН родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, роТро░рпБ роЪро░роорпН родро┐ро░рпБроорпНрокрпБроорпН; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer родро┐ро░рпБроорпНрокрпБроорпН.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.setPublicKey(publicKey[, encoding])</strong></td>
                            <td>Diffie-Hellman рокрпКродрпБ ро╡ро┐роЪрпИропрпИ роЕроорпИроХрпНроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, publicKey роТро░рпБ роЪро░рооро╛роХ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer, TypedArray, роЕро▓рпНро▓родрпБ DataView.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.setPrivateKey(privateKey[, encoding])</strong></td>
                            <td>Diffie-Hellman родройро┐рокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИропрпИ роЕроорпИроХрпНроХро┐ро▒родрпБ. encoding ро╡ро┤роЩрпНроХрокрпНрокроЯрпНроЯро╛ро▓рпН, privateKey роТро░рпБ роЪро░рооро╛роХ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ; роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ Buffer, TypedArray, роЕро▓рпНро▓родрпБ DataView.</td>
                        </tr>
                        <tr>
                            <td><strong>dh.verifyError</strong></td>
                            <td>родрпБро╡роХрпНроХ роЕро▓рпНро▓родрпБ роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ роЪрпЛродройрпИроХро│ро┐ройрпН рокрпЛродрпБ роПро▒рпНрокроЯрпНроЯ роОроирпНродро╡рпКро░рпБ рокро┐ро┤рпИроХро│рпИропрпБроорпН роХрпБро▒ро┐роХрпНроХрпБроорпН роХрпКроЯро┐роХро│ро┐ройрпН рокро┐роЯрпН рокрпБро▓роорпН.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Creating DiffieHellman Instances -->
        <section class="content-section" id="creating-instances">
            <h2>Creating DiffieHellman Instances</h2>
            
            <p>DiffieHellman роиро┐роХро┤рпНро╡рпИ роЙро░рпБро╡ро╛роХрпНроХ рокро▓ ро╡ро┤ро┐роХро│рпН роЙро│рпНро│рой:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Method 1: Generate a new DH group with specified prime length
const dh1 = crypto.createDiffieHellman(2048);
console.log('Generated prime length:', dh1.getPrime().length * 8, 'bits');

// Method 2: Create a DH group using a predefined prime
const prime = Buffer.from('prime-number-in-hex', 'hex');
const dh2 = crypto.createDiffieHellman(prime);

// Method 3: Create a DH group using a predefined prime and generator
const generator = Buffer.from('02', 'hex'); // Often 2, 5, or other small values
const dh3 = crypto.createDiffieHellman(prime, generator);

// Method 4: Using predefined groups with getDiffieHellman()
const predefinedGroupName = 'modp14'; // RFC 3526 2048-bit MODP Group
const dh4 = crypto.getDiffieHellman(predefinedGroupName);</code></pre>
            </div>
            
            <p>getDiffieHellman() роорпБро▒рпИ рокро┐ройрпНро╡ро░рпБроорпН роорпБройрпНроХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роХрпБро┤рпБроХрпНроХро│рпИ роЖродро░ро┐роХрпНроХро┐ро▒родрпБ:</p>
            
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>роХрпБро┤рпБ рокрпЖропро░рпН</th>
                            <th>ро╡ро┐ро│роХрпНроХроорпН</th>
                            <th>роЕро│ро╡рпБ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>modp1</strong></td>
                            <td>RFC 2409 768-bit MODP Group</td>
                            <td>768 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp2</strong></td>
                            <td>RFC 2409 1024-bit MODP Group</td>
                            <td>1024 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp5</strong></td>
                            <td>RFC 3526 1536-bit MODP Group</td>
                            <td>1536 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp14</strong></td>
                            <td>RFC 3526 2048-bit MODP Group</td>
                            <td>2048 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp15</strong></td>
                            <td>RFC 3526 3072-bit MODP Group</td>
                            <td>3072 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp16</strong></td>
                            <td>RFC 3526 4096-bit MODP Group</td>
                            <td>4096 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp17</strong></td>
                            <td>RFC 3526 6144-bit MODP Group</td>
                            <td>6144 bits</td>
                        </tr>
                        <tr>
                            <td><strong>modp18</strong></td>
                            <td>RFC 3526 8192-bit MODP Group</td>
                            <td>8192 bits</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Basic Key Exchange Example -->
        <section class="content-section" id="basic-exchange">
            <h2>Basic Key Exchange Example</h2>
            
            <p>рокро┐ройрпНро╡ро░рпБроорпН роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБ роЗро░рогрпНроЯрпБ родро░рокрпНрокро┐ройро░рпБроХрпНроХрпБ роЗроЯрпИропрпЗ (Alice рооро▒рпНро▒рпБроорпН Bob) роЕроЯро┐рокрпНрокроЯрпИ Diffie-Hellman ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒родрпНродрпИ ро╡ро┐ро│роХрпНроХрпБроХро┐ро▒родрпБ:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Alice generates parameters and keys
console.log('Alice: Creating DiffieHellman instance...');
const alice = crypto.createDiffieHellman(2048);
const aliceKeys = alice.generateKeys();

// Bob also needs parameters from Alice
console.log('Alice: Sending parameters to Bob...');
const p = alice.getPrime();
const g = alice.getGenerator();

// Bob creates a DiffieHellman instance with the same parameters
console.log('Bob: Creating DiffieHellman instance with Alice\'s parameters...');
const bob = crypto.createDiffieHellman(p, g);
const bobKeys = bob.generateKeys();

// Exchange public keys (over an insecure channel)
console.log('Exchanging public keys...');
const alicePublicKey = alice.getPublicKey();
const bobPublicKey = bob.getPublicKey();

// Alice computes the shared secret using Bob's public key
console.log('Alice: Computing shared secret...');
const aliceSecret = alice.computeSecret(bobPublicKey);

// Bob computes the shared secret using Alice's public key
console.log('Bob: Computing shared secret...');
const bobSecret = bob.computeSecret(alicePublicKey);

// Both secrets should be the same
console.log('Alice\'s secret:', aliceSecret.toString('hex'));
console.log('Bob\'s secret:', bobSecret.toString('hex'));
console.log('Do they match?', aliceSecret.equals(bobSecret));

// This shared secret can now be used as a key for symmetric encryption</code></pre>
            </div>
        </section>

        <!-- Using Predefined Groups -->
        <section class="content-section" id="predefined-groups">
            <h2>Using Predefined Groups</h2>
            
            <p>родро░рокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ рокропройрпНрокро╛роЯрпБроХро│рпБроХрпНроХрпБ, роорпБройрпНроХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роХрпБро┤рпБроХрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБ рокрпКро░рпБроирпНродроХрпНроХрпВроЯро┐роп родройрпНроорпИропрпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНродрпБроорпН:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Using the RFC 3526 MODP Group 14 (2048 bits)
console.log('Alice: Creating DiffieHellman using predefined group...');
const alice = crypto.getDiffieHellman('modp14');
alice.generateKeys();

// Bob also uses the same predefined group
console.log('Bob: Creating DiffieHellman using predefined group...');
const bob = crypto.getDiffieHellman('modp14');
bob.generateKeys();

// Exchange public keys (over an insecure channel)
console.log('Exchanging public keys...');
const alicePublicKey = alice.getPublicKey();
const bobPublicKey = bob.getPublicKey();

// Compute shared secrets
const aliceSecret = alice.computeSecret(bobPublicKey);
const bobSecret = bob.computeSecret(alicePublicKey);

// Verify that the shared secrets match
console.log('Do the shared secrets match?', aliceSecret.equals(bobSecret));

// Output information about the group
console.log('Group prime size:', alice.getPrime().length * 8, 'bits');
console.log('Generator value:', alice.getGenerator().toString('hex'));</code></pre>
            </div>
        </section>

        <!-- Diffie-Hellman with Encryption -->
        <section class="content-section" id="dh-with-encryption">
            <h2>Diffie-Hellman with Encryption</h2>
            
            <p>роЗроирпНрод роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБ AES роХрпБро▒ро┐ропро╛роХрпНроХродрпНродро┐ро▒рпНроХро╛рой рокроХро┐ро░рокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИропрпИ роиро┐ро▒рпБро╡ Diffie-Hellman роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родройрпН роорпБро┤рпБроорпИропро╛рой роХро╛роЯрпНроЪро┐ропрпИроХрпН роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Create DiffieHellman instances for Alice and Bob
const alice = crypto.createDiffieHellman(2048);
alice.generateKeys();

// Bob uses Alice's parameters
const bob = crypto.createDiffieHellman(alice.getPrime(), alice.getGenerator());
bob.generateKeys();

// Exchange public keys
const alicePublicKey = alice.getPublicKey();
const bobPublicKey = bob.getPublicKey();

// Compute shared secrets
const aliceSecret = alice.computeSecret(bobPublicKey);
const bobSecret = bob.computeSecret(alicePublicKey);

// Use the shared secret as a key for encryption
// First, derive a suitable key using a hash function
function deriveKey(secret, salt, keyLength) {
  return crypto.pbkdf2Sync(secret, salt, 1000, keyLength, 'sha256');
}

// Alice sends an encrypted message to Bob
function encrypt(text, secret) {
  // Create a salt and derive a key
  const salt = crypto.randomBytes(16);
  const key = deriveKey(secret, salt, 32); // 32 bytes for AES-256
  const iv = crypto.randomBytes(16);
  
  // Encrypt the message
  const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  
  // Return everything Bob needs to decrypt
  return {
    salt: salt.toString('hex'),
    iv: iv.toString('hex'),
    encrypted
  };
}

// Bob decrypts the message from Alice
function decrypt(encryptedInfo, secret) {
  // Parse values
  const salt = Buffer.from(encryptedInfo.salt, 'hex');
  const iv = Buffer.from(encryptedInfo.iv, 'hex');
  const encrypted = encryptedInfo.encrypted;
  
  // Derive the same key
  const key = deriveKey(secret, salt, 32);
  
  // Decrypt the message
  const decipher = crypto.createDecipheriv('aes-256-cbc', key, iv);
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  
  return decrypted;
}

// Alice encrypts a message using the shared secret
const message = 'Hello Bob, this is a secret message from Alice!';
console.log('Original message:', message);

const encryptedMessage = encrypt(message, aliceSecret);
console.log('Encrypted message:', encryptedMessage);

// Bob decrypts the message using his shared secret
const decryptedMessage = decrypt(encryptedMessage, bobSecret);
console.log('Decrypted message:', decryptedMessage);</code></pre>
            </div>
        </section>

        <!-- Working with Custom Parameters -->
        <section class="content-section" id="custom-parameters">
            <h2>Working with Custom Parameters</h2>
            
            <p>Diffie-Hellman роХрпНроХрпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ роЕро│ро╡рпБро░рпБроХрпНроХро│рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН рокрпЛродрпБ:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Custom prime and generator values
// These would normally be carefully chosen for security
const primeHex = `
  ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74
  020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f1437
  4fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7ed
  ee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf05
  98da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb
  9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3b
  e39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf695581718
  3995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff
`.replace(/\s+/g, '');

const prime = Buffer.from(primeHex, 'hex');
const generator = Buffer.from('02', 'hex');

// Create DiffieHellman with custom parameters
const dh = crypto.createDiffieHellman(prime, generator);

// Generate keys
dh.generateKeys();

// Verify the parameters
console.log('Using custom prime of length:', prime.length * 8, 'bits');
console.log('Generator:', generator.toString('hex'));

// Validation
console.log('Verify error code:', dh.verifyError);
if (dh.verifyError) {
  console.error('The parameters did not pass validation!');
} else {
  console.log('The parameters passed validation.');
}

// Output public and private keys
console.log('Public key length:', dh.getPublicKey().length * 8, 'bits');
console.log('Private key length:', dh.getPrivateKey().length * 8, 'bits');</code></pre>
            </div>
        </section>

        <!-- Key Generation with Specific Encoding -->
        <section class="content-section" id="key-encoding">
            <h2>Key Generation with Specific Encoding</h2>
            
            <p>DiffieHellman ро╡ро┐роЪрпИроХро│рпБроЯройрпН рокрогро┐рокрпБро░ро┐ропрпБроорпН рокрпЛродрпБ роирпАроЩрпНроХро│рпН роХрпБро▒ро┐ропрпАроЯрпБроХро│рпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯро▓ро╛роорпН:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Create DiffieHellman instance
const dh = crypto.createDiffieHellman(1024);

// Generate keys
dh.generateKeys();

// Get keys and parameters with different encodings
console.log('With Buffer (default):');
console.log('  - Prime:', dh.getPrime());
console.log('  - Generator:', dh.getGenerator());
console.log('  - Public Key:', dh.getPublicKey());
console.log('  - Private Key:', dh.getPrivateKey());

console.log('\nWith hex encoding:');
console.log('  - Prime:', dh.getPrime('hex'));
console.log('  - Generator:', dh.getGenerator('hex'));
console.log('  - Public Key:', dh.getPublicKey('hex'));
console.log('  - Private Key:', dh.getPrivateKey('hex'));

console.log('\nWith base64 encoding:');
console.log('  - Prime:', dh.getPrime('base64'));
console.log('  - Generator:', dh.getGenerator('base64'));
console.log('  - Public Key:', dh.getPublicKey('base64'));
console.log('  - Private Key:', dh.getPrivateKey('base64'));

// Set keys using specific encoding
const newPublicKey = crypto.randomBytes(dh.getPrime().length - 10);
dh.setPublicKey(newPublicKey);
console.log('\nAfter setting new public key:');
console.log('  - Public Key (hex):', dh.getPublicKey('hex'));</code></pre>
            </div>
        </section>

        <!-- Error Handling -->
        <section class="content-section" id="error-handling">
            <h2>Error Handling</h2>
            
            <p>роХро┐ро░ро┐рокрпНроЯрпЛроХро┐ро░ро╛роГрокро┐роХрпН роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпБроЯройрпН рокрогро┐рокрпБро░ро┐ропрпБроорпН рокрпЛродрпБ рокро┐ро┤рпИ роХрпИропро╛ро│рпБродро▓рпН роорпБроХрпНроХро┐ропрооро╛ройродрпБ:</p>
            
            <div class="code-example">
                <pre><code>const crypto = require('crypto');

// Function to safely create DiffieHellman
function createDHSafely(options) {
  try {
    let dh;
    
    if (typeof options === 'number') {
      // Create with prime length
      dh = crypto.createDiffieHellman(options);
    } else if (options.group) {
      // Create with predefined group
      dh = crypto.getDiffieHellman(options.group);
    } else if (options.prime) {
      // Create with custom prime and optional generator
      const prime = Buffer.from(options.prime, options.encoding || 'hex');
      const generator = options.generator ?
        Buffer.from(options.generator, options.encoding || 'hex') :
        undefined;
      
      dh = generator ?
        crypto.createDiffieHellman(prime, generator) :
        crypto.createDiffieHellman(prime);
    } else {
      throw new Error('Invalid options for DiffieHellman creation');
    }
    
    // Check for errors
    if (dh.verifyError) {
      const errors = [];
      // Check specific error flags
      if (dh.verifyError & crypto.constants.DH_CHECK_P_NOT_SAFE_PRIME)
        errors.push('DH_CHECK_P_NOT_SAFE_PRIME');
      if (dh.verifyError & crypto.constants.DH_CHECK_P_NOT_PRIME)
        errors.push('DH_CHECK_P_NOT_PRIME');
      if (dh.verifyError & crypto.constants.DH_UNABLE_TO_CHECK_GENERATOR)
        errors.push('DH_UNABLE_TO_CHECK_GENERATOR');
      if (dh.verifyError & crypto.constants.DH_NOT_SUITABLE_GENERATOR)
        errors.push('DH_NOT_SUITABLE_GENERATOR');
      
      throw new Error(`DiffieHellman parameter validation failed: ${errors.join(', ')}`);
    }
    
    return dh;
  } catch (error) {
    console.error('Error creating DiffieHellman instance:', error.message);
    throw error;
  }
}

// Test with valid options
try {
  const dh1 = createDHSafely(2048);
  console.log('Successfully created DH with 2048-bit prime');
  
  const dh2 = createDHSafely({ group: 'modp14' });
  console.log('Successfully created DH with predefined group modp14');
} catch (error) {
  console.error('Error in valid tests:', error.message);
}

// Test with invalid options
try {
  // Invalid prime value
  const invalidPrime = '12345'; // Too short, not a prime
  const dh3 = createDHSafely({
    prime: invalidPrime,
    encoding: 'hex'
  });
} catch (error) {
  console.error('Expected error with invalid prime:', error.message);
}

try {
  // Invalid group name
  const dh4 = createDHSafely({ group: 'nonexistent-group' });
} catch (error) {
  console.error('Expected error with invalid group:', error.message);
}</code></pre>
            </div>
        </section>

        <!-- Security Considerations -->
        <section class="content-section" id="security-considerations">
            <h2>Security Considerations</h2>
            
            <p>Diffie-Hellman ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒родрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН рокрпЛродрпБ, роЗроирпНрод рокро╛родрпБроХро╛рокрпНрокрпБ роЪро┐ро▒роирпНрод роироЯрпИроорпБро▒рпИроХро│рпИроХрпН роХро╡ройро┐ропрпБроЩрпНроХро│рпН:</p>
            
            <div class="best-practice-list">
                <div class="practice-item positive">
                    <i class="fas fa-ruler"></i>
                    <span><strong>рокрпКро░рпБродрпНродрооро╛рой ро╡ро┐роЪрпИ роЕро│ро╡рпБроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:</strong> роиро╡рпАрой рокропройрпНрокро╛роЯрпБроХро│рпБроХрпНроХрпБ, роХрпБро▒рпИроирпНродродрпБ 2048-рокро┐роЯрпН роорпБродройрпНроорпИроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-check-square"></i>
                    <span><strong>роЪро░ро┐рокро╛ро░рпНроХрпНроХрокрпНрокроЯрпНроЯ роХрпБро┤рпБроХрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:</strong> роОрокрпНрокрпЛродрпБроорпН роорпБроЯро┐роирпНродро╛ро▓рпН, RFCроХро│ро┐ро▓рпН ро╡ро░рпИропро▒рпБроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│ родро░рокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роХрпБро┤рпБроХрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-shield-alt"></i>
                    <span><strong>родройро┐рокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИроХро│рпИрокрпН рокро╛родрпБроХро╛роХрпНроХро╡рпБроорпН:</strong> рокродро┐ро╡рпБроХро│рпН, рокро┐ро┤рпИродрпНродро┐ро░рпБродрпНрод ро╡рпЖро│ро┐ропрпАроЯрпБ роЕро▓рпНро▓родрпБ роХро┐ро│рпИропройрпНроЯрпН-роЪрпИроЯрпН роХрпБро▒ро┐ропрпАроЯрпНроЯро┐ро▓рпН родройро┐рокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИроХро│рпИ ро╡рпЖро│ро┐рокрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯро╛роорпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-user-check"></i>
                    <span><strong>роЕроЩрпНроХрпАроХро╛ро░родрпНродрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:</strong> родрпВроп Diffie-Hellman роироЯрпБро╡ро░рпН родро╛роХрпНроХрпБродро▓рпНроХро│рпБроХрпНроХрпБ рокро╛родро┐роХрпНроХрокрпНрокроЯроХрпНроХрпВроЯро┐ропродрпБ. роЯро┐роЬро┐роЯрпНроЯро▓рпН роХрпИропрпКрокрпНрокроЩрпНроХро│рпБроЯройрпН ECDHE рокрпЛройрпНро▒ роЕроЩрпНроХрпАроХро░ро┐роХрпНроХрокрпНрокроЯрпНроЯ ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒ роирпЖро▒ро┐роорпБро▒рпИроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родрпИроХрпН роХро╡ройро┐ропрпБроЩрпНроХро│рпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-search"></i>
                    <span><strong>роЕро│ро╡рпБро░рпБ роЪро░ро┐рокро╛ро░рпНрокрпНрокрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН:</strong> роЕро│ро╡рпБро░рпБроХрпНроХро│рпН роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛роХрпБроорпН роОройрпНрокродрпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНрод роОрокрпНрокрпЛродрпБроорпН dh.verifyError роРроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-sync"></i>
                    <span><strong>роХрпБро▒рпБроХро┐роп роХро╛ро▓ ро╡ро┐роЪрпИроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:</strong> роорпБройрпНройрпЛроХрпНроХро┐ роЗро░роХроЪро┐ропродрпНродрпИ ро╡ро┤роЩрпНроХ роТро╡рпНро╡рпКро░рпБ роЕрооро░рпНро╡рпБроХрпНроХрпБроорпН рокрпБродро┐роп ро╡ро┐роЪрпИроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН.</span>
                </div>
                <div class="practice-item positive">
                    <i class="fas fa-key"></i>
                    <span><strong>роХрпБро▒ро┐ропро╛роХрпНроХ ро╡ро┐роЪрпИроХро│рпИ роЪро░ро┐ропро╛роХрокрпН рокрпЖро▒ро╡рпБроорпН:</strong> рокроХро┐ро░рокрпНрокроЯрпНроЯ ро░роХроЪро┐ропродрпНродрпИ роирпЗро░роЯро┐ропро╛роХ роХрпБро▒ро┐ропро╛роХрпНроХ ро╡ро┐роЪрпИропро╛роХрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯро╛роорпН. HKDF роЕро▓рпНро▓родрпБ PBKDF2 рокрпЛройрпНро▒ ро╡ро┐роЪрпИ рокрпЖро▒рпБродро▓рпН роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИрокрпН (KDF) рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.</span>
                </div>
            </div>
        </section>

        <!-- Comparing with ECDH -->
        <section class="content-section" id="comparing-ecdh">
            <h2>Comparing with ECDH</h2>
            
            <p>Diffie-Hellman (DH) рооро▒рпНро▒рпБроорпН Elliptic Curve Diffie-Hellman (ECDH) роЗро░рогрпНроЯрпБроорпН ро╡ро┐роЪрпИ рокро░ро┐рооро╛ро▒рпНро▒ роирпЖро▒ро┐роорпБро▒рпИроХро│рпН, роЖройро╛ро▓рпН ECDH роиройрпНроорпИроХро│рпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ:</p>
            
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>роЕроорпНроЪроорпН</th>
                            <th>DiffieHellman</th>
                            <th>ECDH</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ро╡ро┐роЪрпИ роЕро│ро╡рпБ</strong></td>
                            <td>рокрпКродрпБро╡ро╛роХ 2048-4096 рокро┐роЯрпНроХро│рпН</td>
                            <td>рокрпКродрпБро╡ро╛роХ 256-384 рокро┐роЯрпНроХро│рпН</td>
                        </tr>
                        <tr>
                            <td><strong>роЪрпЖропро▓рпНродро┐ро▒ройрпН</strong></td>
                            <td>роорпЖродрпБро╡ро╛роХ, роЕродро┐роХ роХрогроХрпНроХрпАроЯрпБ родрпЗро╡рпИ</td>
                            <td>ро╡рпЗроХрооро╛роХ, рооро┐роХро╡рпБроорпН родро┐ро▒роорпИропро╛ройродрпБ</td>
                        </tr>
                        <tr>
                            <td><strong>рокро╛родрпБроХро╛рокрпНрокрпБ роиро┐ро▓рпИ</strong></td>
                            <td>2048-рокро┐роЯрпН DH тЙИ 112-рокро┐роЯрпН рокро╛родрпБроХро╛рокрпНрокрпБ</td>
                            <td>256-рокро┐роЯрпН ECDH тЙИ 128-рокро┐роЯрпН рокро╛родрпБроХро╛рокрпНрокрпБ</td>
                        </tr>
                        <tr>
                            <td><strong>роиро┐ройрпИро╡роХ рокропройрпНрокро╛роЯрпБ</strong></td>
                            <td>роЕродро┐роХ</td>
                            <td>роХрпБро▒рпИроирпНрод</td>
                        </tr>
                        <tr>
                            <td><strong>роиро╡рпАрой рокропройрпНрокро╛роЯрпБ</strong></td>
                            <td>рокрпБродро┐роп ро╡роЯро┐ро╡роорпИрокрпНрокрпБроХро│ро┐ро▓рпН роХрпБро▒рпИро╡ро╛роХ рокрпКродрпБро╡ро╛ройродрпБ</td>
                            <td>рокрпБродро┐роп роирпЖро▒ро┐роорпБро▒рпИроХро│ро┐ро▓рпН рооро┐роХро╡рпБроорпН рокрпКродрпБро╡ро╛ройродрпБ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="tip-box">
                <h4><span class="tip-icon">ЁЯТб</span> роорпБроХрпНроХро┐роп роХрпБро▒ро┐рокрпНрокрпБ:</h4>
                <p>роЕродройрпН роЪро┐ро▒роирпНрод роЪрпЖропро▓рпНродро┐ро▒ройрпН рооро▒рпНро▒рпБроорпН роЪро┐ро▒ро┐роп ро╡ро┐роЪрпИ роЕро│ро╡рпБроХро│рпБроХрпНроХро╛роХ, рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой роиро╡рпАрой рокропройрпНрокро╛роЯрпБроХро│ро┐ро▓рпН ECDH ро╡ро┐ро░рпБроорпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ.</p>
            </div>
        </section>

        <!-- Exercise Section -->
        <section class="content-section" id="exercise">
            <h2>рокропро┐ро▒рпНроЪро┐</h2>
            
            <div class="exercise-box">
                <h4><span class="exercise-icon">тЭУ</span> Node.js роЗро▓рпН DiffieHellman роиро┐роХро┤рпНро╡рпИ роЙро░рпБро╡ро╛роХрпНроХ рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроорпН роЪро░ро┐ропро╛рой роорпБро▒рпИропрпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН.</h4>
                
                <div class="options-grid">
                    <div class="option-card" data-correct="false">
                        <div class="option-content">
                            <div class="option-text">crypto.createDH()</div>
                            <div class="option-feedback incorrect">тЬЧ родро╡ро▒рпБ! "crypto.createDH()" роОройрпНрокродрпБ Node.js роЗро▓рпН роТро░рпБ роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛роХрпБроорпН роорпБро▒рпИ роЕро▓рпНро▓</div>
                        </div>
                    </div>
                    
                    <div class="option-card" data-correct="true">
                        <div class="option-content">
                            <div class="option-text">crypto.createDiffieHellman()</div>
                            <div class="option-feedback correct">тЬУ роЪро░ро┐! "crypto.createDiffieHellman()" роОройрпНрокродрпБ Node.js роЗро▓рпН DiffieHellman роиро┐роХро┤рпНро╡рпИ роЙро░рпБро╡ро╛роХрпНроХ рокропройрпНрокроЯрпБроорпН роЪро░ро┐ропро╛рой роорпБро▒рпИропро╛роХрпБроорпН</div>
                        </div>
                    </div>
                    
                    <div class="option-card" data-correct="false">
                        <div class="option-content">
                            <div class="option-text">crypto.makeDiffieHellman()</div>
                            <div class="option-feedback incorrect">тЬЧ родро╡ро▒рпБ! "crypto.makeDiffieHellman()" роОройрпНрокродрпБ Node.js роЗро▓рпН роТро░рпБ роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛роХрпБроорпН роорпБро▒рпИ роЕро▓рпНро▓</div>
                        </div>
                    </div>
                    
                    <div class="option-card" data-correct="false">
                        <div class="option-content">
                            <div class="option-text">crypto.initDiffieHellman()</div>
                            <div class="option-feedback incorrect">тЬЧ родро╡ро▒рпБ! "crypto.initDiffieHellman()" роОройрпНрокродрпБ Node.js роЗро▓рпН роТро░рпБ роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛роХрпБроорпН роорпБро▒рпИ роЕро▓рпНро▓</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <a href="Node.js Decipher Reference.html" class="nav-tab prev">
                <i class="fas fa-arrow-left"></i>
                <span>роорпБроирпНродрпИроп</span>
            </a>
            <a href="Node.js ECDH Reference.html" class="nav-tab next">
                <span>роЕроЯрпБродрпНродродрпБ</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>Jassif Team Institution</h3>
                <p>Leading educational institution providing quality programming education in Tamil.</p>
            </div>
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#diffiehellman-object">DiffieHellman Object</a></li>
                    <li><a href="#diffiehellman-methods">DiffieHellman Methods</a></li>
                    <li><a href="#basic-exchange">Basic Key Exchange</a></li>
                    <li><a href="#dh-with-encryption">DH with Encryption</a></li>
                    <li><a href="#security-considerations">Security Considerations</a></li>
                    <li><a href="#exercise">рокропро┐ро▒рпНроЪро┐</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Contact</h3>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Location & Hours</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Follow Us</h3>
                <ul>
                    <li><a href="#"><i class="fab fa-facebook"></i> Facebook</a></li>
                    <li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li>
                    <li><a href="#"><i class="fab fa-youtube"></i> YouTube</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2023 Jassif Team Institution. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if(targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if(targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Add scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animation = 'fadeInUp 0.8s ease-out forwards';
                }
            });
        }, observerOptions);
        
        // Observe all content sections for animation
        document.querySelectorAll('.content-section').forEach(section => {
            observer.observe(section);
        });

        // Exercise interaction
        document.querySelectorAll('.option-card').forEach(card => {
            card.addEventListener('click', function() {
                // Show feedback for all options
                document.querySelectorAll('.option-card').forEach(c => {
                    c.querySelector('.option-feedback').style.display = 'block';
                });
            });
        });
    </script>

    <!-- Home Button -->
    <a href="index.html" class="home-icon">
        <i class="fas fa-home"></i>
    </a>
</body>
</html>